<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DKUT Resource Centre - Sample Page</title>
<style>
  body { font-family: Arial, sans-serif; background: #f2f2f2; padding: 20px; }
  h1 { margin-bottom: 10px; }
  #counter { font-weight: bold; color: #0f0; font-size: 18px; margin-bottom: 20px; }
  .school-list { margin-top: 20px; }
  .school { padding: 10px; margin-bottom: 5px; background: #fff; border-radius: 5px; }
</style>
</head>
<body>

<h1>Welcome to DKUT Resource Centre</h1>

<!-- Live user counter -->
<div id="counter">ğŸ‘¥ Active Users on this page: <span id="online-count">0</span></div>

<div class="school-list">
  <div class="school">âš™ï¸ School of Engineering</div>
  <div class="school">ğŸ’¼ School of Business Management and Economics</div>
</div>

<script type="module">
  // --- Firebase SDK ---
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref, onDisconnect, onValue, push, set, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  // --- Firebase config ---
  const firebaseConfig = {
    apiKey: "AIzaSyB7pfbXBZTPfQYkwJhZx7-p2S9-9flhdE8",
    authDomain: "dekutconnect-official.firebaseapp.com",
    databaseURL: "https://dekutconnect-official-default-rtdb.firebaseio.com",
    projectId: "dekutconnect-official",
    storageBucket: "dekutconnect-official.firebasestorage.app",
    messagingSenderId: "934091852918",
    appId: "1:934091852918:web:d57dc1a9eb6b24c06d2357",
    measurementId: "G-YKYK3WFCDF"
  };

  // --- Initialize Firebase ---
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // --- Auto-detect page identity ---
  const pageKey = location.pathname.replace(/\//g, "_") || "home";
  const connectionsRef = ref(db, `connections${pageKey}`);

  // --- Track current user ---
  const myConnection = push(connectionsRef);
  set(myConnection, { connectedAt: serverTimestamp() });
  onDisconnect(myConnection).remove();

  // --- Update live counter ---
  const counterEl = document.getElementById("online-count");
  onValue(connectionsRef, snapshot => {
    const count = snapshot.size || Object.keys(snapshot.val() || {}).length;
    counterEl.textContent = count;
  });
</script>

</body>
</html>
